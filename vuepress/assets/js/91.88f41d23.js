(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{604:function(t,e,n){"use strict";n.r(e);var o={data:function(){return{show:!1,loading:!1}},methods:{onPreview:function(t){var e=this;this.loading=!0;var n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",t,!0),n.responseType="blob",n.onload=function(){e.show=!0;var t=n.response;e.readFile(t)},n.send()},onFileChange:function(t){var e=t.target.files||[];if(e.length){var n=e[0];this.readFile(n)}},readFile:function(t){var e=this,n=new FileReader;n.onloadend=function(t){var o=n.result;mammoth.convertToHtml({arrayBuffer:o}).then(function(t){e.show=!0,e.loading=!1,e.$nextTick(function(){e.$refs.wordPreviewContent.innerHTML=t.value})})},n.readAsArrayBuffer(t)}}},r=n(12),i=Object(r.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"word-preview-wrapper"},[n("RemoteScript",{attrs:{src:"https://cdn.jsdelivr.net/npm/mammoth@1.4.8/mammoth.browser.min.js"}}),t._v(" "),n("ul",[n("li",[t._v("\n                服务器的文件：\n                "),n("a",{attrs:{href:"../../static/word文档1.docx"}},[t._v("word文档1")]),t._v(" "),n("el-button",{attrs:{loading:t.loading},on:{click:function(e){return e.preventDefault(),t.onPreview("../../static/word文档1.docx")}}},[t._v("预览")])],1),t._v(" "),n("li",[t._v("\n                本地上传：\n                "),n("input",{attrs:{type:"file",accept:".doc,.docx"},on:{change:t.onFileChange}})])]),t._v(" "),n("el-dialog",{attrs:{title:"预览",visible:t.show,top:"0",width:"80%"},on:{"update:visible":function(e){t.show=e}}},[n("div",{ref:"wordPreviewContent",staticClass:"word-preview-content"}),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.show=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.show=!1}}},[t._v("确 定")])],1)])],1)},[],!1,null,null,null);e.default=i.exports}}]);