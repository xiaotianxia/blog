(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{722:function(t,e,r){"use strict";r.r(e);var a=r(12),i=Object(a.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"安全性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安全性","aria-hidden":"true"}},[t._v("#")]),t._v(" 安全性")]),t._v(" "),r("h2",{attrs:{id:"xss攻击的原理、分类、具体案例，如何防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xss攻击的原理、分类、具体案例，如何防御","aria-hidden":"true"}},[t._v("#")]),t._v(" XSS攻击的原理、分类、具体案例，如何防御")]),t._v(" "),r("h3",{attrs:{id:"原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),r("ul",[r("li",[t._v("XSS (Cross-Site Scripting)，跨站脚本攻击")]),t._v(" "),r("li",[t._v("通过网站漏洞，设法使用户端运行非法脚本")])]),t._v(" "),r("h3",{attrs:{id:"分类"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#分类","aria-hidden":"true"}},[t._v("#")]),t._v(" 分类")]),t._v(" "),r("ul",[r("li",[t._v("非持久型XSS (反射型XSS)\n"),r("ul",[r("li",[t._v("不经过数据库存储，通过http请求一次性完成攻击")]),t._v(" "),r("li",[t._v("攻击者需要诱骗点击，必须要通过用户点击链接才能发起")])])]),t._v(" "),r("li",[t._v("持久型XSS (存储型XSS)\n"),r("ul",[r("li",[t._v("持久性，植入在数据库中")]),t._v(" "),r("li",[t._v("危害面广")])])])]),t._v(" "),r("h3",{attrs:{id:"案例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#案例","aria-hidden":"true"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),r("ul",[r("li",[t._v("非持久型\n"),r("ul",[r("li",[t._v("在 URL、document.referrer、document.forms 等这种 DOM API 中获取数据直接渲染。")]),t._v(" "),r("li",[t._v("使用 eval、new Function()、document.write()、document.writeln()、window.setInterval()、window.setTimeout()、innerHTML、document.createElement() 等可执行字符串的方法。")])])]),t._v(" "),r("li",[t._v("持久型\n"),r("ul",[r("li",[t._v("提交表单后端没做处理直接入库")]),t._v(" "),r("li",[t._v("后端从数据库中取出数据没做转义直接输出给前端")]),t._v(" "),r("li",[t._v("前端拿到后端数据没做转义直接渲染成 DOM")])])])]),t._v(" "),r("h3",{attrs:{id:"防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#防御","aria-hidden":"true"}},[t._v("#")]),t._v(" 防御")]),t._v(" "),r("ul",[r("li",[t._v("CSP (Content-Security-Policy) "),r("a",{attrs:{href:"https://www.jianshu.com/p/a8b769e7d4bd",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[t._v("设置 HTTP Header 中的 Content-Security-Policy")]),t._v(" "),r("li",[t._v("设置 meta 标签的方式")])])]),t._v(" "),r("li",[t._v("转义字符\n"),r("ul",[r("li",[t._v("对引号、尖括号、斜杠进行转义")])])]),t._v(" "),r("li",[t._v("HttpOnly Cookie\n"),r("ul",[r("li",[t._v("设置 cookie 时，将其属性设为 HttpOnly (只能通过服务端设置) ，就可以避免该网页的 cookie 被客户端恶意 js 窃取，保护用户 cookie 信息。")]),t._v(" "),r("li",[t._v("当 cookie 带 httpOnly 选项时，客户端则无法通过 js 代码去访问（包括读取、修改、删除等）这个 cookie")])])])]),t._v(" "),r("h2",{attrs:{id:"csrf攻击的原理，如何防御"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#csrf攻击的原理，如何防御","aria-hidden":"true"}},[t._v("#")]),t._v(" CSRF攻击的原理，如何防御")]),t._v(" "),r("h3",{attrs:{id:"原理-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#原理-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),r("p",[t._v("CSRF(Cross Site Request Forgery)，即跨站请求伪造。它利用用户已登录的身份，在用户毫不知情的情况下，以用户的名义完成非法操作。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://github.com/xiaotianxia/blog/blob/gh-pages/static/csrf.png",alt:"CSRF"}})]),t._v(" "),r("p",[t._v("完成 CSRF 攻击必须要有三个条件：")]),t._v(" "),r("ul",[r("li",[t._v("用户已经登录了站点 A，并在本地记录了 cookie")]),t._v(" "),r("li",[t._v("在用户没有登出站点 A 的情况下（也就是 cookie 生效的情况下），访问了恶意攻击者提供的引诱危险站点 B (B 站点要求访问站点A)。")]),t._v(" "),r("li",[t._v("站点 A 没有做任何 CSRF 防御")])]),t._v(" "),r("h3",{attrs:{id:"防御-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#防御-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 防御")]),t._v(" "),r("p",[t._v("防范 CSRF 攻击可以遵循以下几种规则：")]),t._v(" "),r("ul",[r("li",[t._v("不用 get 请求修改数据库数据")]),t._v(" "),r("li",[t._v("不让第三方网站访问到用户 Cookie")]),t._v(" "),r("li",[t._v("阻止第三方网站请求接口")]),t._v(" "),r("li",[t._v("请求时附带验证信息，比如验证码或者 token")])]),t._v(" "),r("p",[t._v("防御措施")]),t._v(" "),r("ul",[r("li",[t._v("SameSite\n"),r("ul",[r("li",[t._v("可以对 Cookie 设置 SameSite 属性。该属性表示 Cookie 不随着跨域请求发送，可以很大程度减少 CSRF 的攻击，但是该属性目前并不是所有浏览器都兼容。")])])]),t._v(" "),r("li",[t._v("Referer Check\n"),r("ul",[r("li",[t._v("HTTP Referer是header的一部分，当浏览器向web服务器发送请求时，一般会带上Referer信息告诉服务器是从哪个页面链接过来的，服务器借此可以获得一些信息用于处理。可以通过检查请求的来源来防御CSRF攻击。正常请求的referer具有一定规律，如在提交表单的referer必定是在该页面发起的请求。所以通过检查http包头referer的值是不是这个页面，来判断是不是CSRF攻击。")])])]),t._v(" "),r("li",[t._v("Anti CSRF Token")]),t._v(" "),r("li",[t._v("验证码")])]),t._v(" "),r("h2",{attrs:{id:"其他攻击手段"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他攻击手段","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他攻击手段")]),t._v(" "),r("ul",[r("li",[t._v("点击劫持\n"),r("ul",[r("li",[t._v("点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击。")])])]),t._v(" "),r("li",[t._v("URL跳转漏洞")]),t._v(" "),r("li",[t._v("SQL注入")])]),t._v(" "),r("h2",{attrs:{id:"http劫持、dns劫持的原理、防御措施"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#http劫持、dns劫持的原理、防御措施","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP劫持、DNS劫持的原理、防御措施")]),t._v(" "),r("p",[t._v("运营商通过某些方式篡改了用户正常访问的网页，插入广告或者其他一些杂七杂八的东西。")]),t._v(" "),r("h3",{attrs:{id:"http劫持"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#http劫持","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP劫持")]),t._v(" "),r("p",[t._v("在运营商的路由器节点上，设置协议检测，一旦发现是HTTP请求，而且是html类型请求，则拦截处理。后续做法往往分为2种，1种是类似DNS劫持返回302让用户浏览器跳转到另外的地址，还有1种是在服务器返回的HTML数据中插入js或dom节点（广告）。")]),t._v(" "),r("h3",{attrs:{id:"dns劫持"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dns劫持","aria-hidden":"true"}},[t._v("#")]),t._v(" DNS劫持")]),t._v(" "),r("p",[t._v("一般而言，用户上网的DNS服务器都是运营商分配的，所以，在这个节点上，运营商可以为所欲为。")]),t._v(" "),r("p",[t._v("例如，访问http://jiankang.qq.com/index.html，正常DNS应该返回腾讯的ip，而DNS劫持后，会返回一个运营商的中间服务器ip。访问该服务器会一致性的返回302，让用户浏览器跳转到预处理好的带广告的网页，在该网页中再通过iframe打开用户原来访问的地址。")]),t._v(" "),r("ul",[r("li",[t._v("直接修改网站IP")])]),t._v(" "),r("h3",{attrs:{id:"防御措施"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#防御措施","aria-hidden":"true"}},[t._v("#")]),t._v(" 防御措施")]),t._v(" "),r("ul",[r("li",[t._v("https 终级方案\n"),r("ul",[r("li",[t._v("优点：一劳永逸")]),t._v(" "),r("li",[t._v("缺点：成本高，对网站性能有影响，可能需要修改权限")])])]),t._v(" "),r("li",[t._v("绕过劫持\n"),r("ul",[r("li",[t._v("检测是否有额外的DOM插入，检测插入的DOM中是否有白名单以外的链接")])])])]),t._v(" "),r("p",[t._v("参考\n"),r("a",{attrs:{href:"https://github.com/ljianshu/Blog/issues/56",target:"_blank",rel:"noopener noreferrer"}},[t._v("1"),r("OutboundLink")],1),t._v(" "),r("a",{attrs:{href:"https://github.com/lgwebdream/FE-Interview/issues/16",target:"_blank",rel:"noopener noreferrer"}},[t._v("2"),r("OutboundLink")],1)])])},[],!1,null,null,null);e.default=i.exports}}]);